<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <!-- import CSS -->
  <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
</head>

<body>
  <div id="app">
    <el-input type="textarea" :autosize="{ minRows: 4, maxRows: 7}" placeholder="请输入json" v-model="json"></el-input>
    <el-button @click="revertJson">转换</el-button>
    <el-input type="textarea" :autosize="{ minRows: 4, maxRows: 7}" placeholder="结果" v-model="result"></el-input>
  </div>
</body>
<!-- import Vue before Element -->
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<!-- import JavaScript -->
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script>
  function toJson(name, jsonStr) {
    var json = eval('(' + jsonStr + ')');
    var explain = '///\t' + jsonStr + '\n';
    var field = '\tString ';
    var constructor_none = '\t' + name + '(): ';
    var constructor_json = '\t' + name + '.fromJson(dynamic json) {\n\t\t';
    var first = true;
    for (key in json) {
      if (first) {
        constructor_json += 'if (json != null && json is Map) {\n';
        field += key;
        constructor_none += key + ' = \'\'';
      } else {
        field += ', ' + key;
        constructor_none += ', ' + key + ' = \'\'';
      }
      explain += '///\t' + key + ' = ' + json[key] + '\n';
      constructor_json += '\t\t\t' + key + ' = json[\'' + key + '\'];\n';
      first = false;
    }
    return explain + 'class ' + name + ' {\n' + field + ';\n\n' + constructor_none + ';\n\n' + constructor_json + '\t\t}\n\t}\n}';
  };
  new Vue({
    el: '#app',
    data: {
      json: '',
      result: '',
    },
    methods: {
      revertJson: function () {
        this.result = toJson('Entity', this.json);
      }
    },
  })
</script>

</html>
